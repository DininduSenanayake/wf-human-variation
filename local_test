module purge
module unload XALT
module load Nextflow/22.10.3
module load Singularity/3.10.3

mkdir /dev/shm/dsen018
export SINGULARITY_TMPDIR=/dev/shm/dsen018 
export SINGULARITY_CACHEDIR=$SINGULARITY_TMPDIR

export NXF_EXECUTOR=slurm
export NXF_SINGULARITY_CACHEDIR=/nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-human-variation/singularity_tmpcache


MODEL='/nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-hv-demo_data/ont_r104_e81_sup_g5015'
REFERENCE='nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-hv-demo_data/demo.fasta'
TDREPETS='/nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-hv-demo_data/human_GRCh38_no_alt_analysis_set.trf.bed'
OUTPUT='/nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-hv-demo_data/results'
NFCONFIG='/nesi/nobackup/nesi99999/Dinindu/ZDissues/wf-human-variation/nextflow.config'


# pull nextflow pipeline (if haven't already)
nextflow run epi2me-labs/wf-human-variation --help  
  
nextflow -c ${NFCONFIG} run epi2me-labs/wf-human-variation \
    -profile singularity \
    --snp --sv \
    --bam demo_data/demo.bam \
    --bed demo_data/demo.bed \
    --ref demo_data/demo.fasta \
    --model demo_data/ont_r104_e81_sup_g5015 \
    --sample_name DEMO \
    --out_dir ${OUTPUT} \
    --threads 8
    
rm -rf /dev/shm/dsen018